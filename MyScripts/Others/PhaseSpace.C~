void PhaseSpace() {

  Double_t Mass1 = 1869./1000.;
  Double_t Mass2 = 500./1000.;
  Double_t Mass3 = 493./1000.;
  Double_t Mass4 = 0.511/1000.;

  TH2D* h2 = new TH2D("h2", "", 50, 0.5, 4., 50, 0., 2.5);
  TLorentzVector Mother(0., 0., 0., Mass1);
  Double_t Daughters[3] = {Mass2, Mass3, Mass4} ;
  TGenPhaseSpace Event;

  Event.SetDecay(Mother, 3, Daughters);

  for (Int_t n = 0; n < 100000; n++) {
    Double_t W = Event.Generate();
    TLorentzVector *p1 = Event.GetDecay(0);
    TLorentzVector *p2 = Event.GetDecay(1);
    TLorentzVector *p3 = Event.GetDecay(2);
    TLorentzVector p12 = *p1 + *p2;
    TLorentzVector p13 = *p1 + *p3;

    h2->Fill(p12.M2(), p13.M2(), W);
  }
  h2->Draw("colz");
}
